# Human pose & Safety monitoring
## 前言
  10月初为报名某比赛看了一点论文和专利，构想了整个项目，等到写完文本时近乎放弃，呜呼哀哉，10月实无DL方面的输出，于是就在此写写当初的构想吧。至于为何放弃，不仅受限于个人技术，也有资源、团队等等因素，不便多言也一言难尽。

（以下内容多源于比赛文本，虽简陋，但系团队成员劳动，请勿作他用，不胜感激）
## 系统设计
  系统采用边缘计算，在获取图像的硬件设备上使用优化过的轻量级深度神经网络对图像进行实时检测，并对提取出的姿态信息采用我们提出的跌倒预估算法进行评判，将判断结果通过少量、加密数据的形式上传到云服务器，最终云服务器根据姿态异常信息（如果有），查找数据库中的相应联系信息并发送报警消息。
  技术点：边缘计算、网络通信、云存储、姿态估计、姿态判断。
## 姿态估计
  因为系统是以应用深度学习技术为关键点的，所以在这里也大致讲讲我设想的深度学习姿态估计方法（其他技术点不写了，请见谅）。
  
  到目前为止，所有的人体姿态检测方法可分为两种的方向：自顶向下（top-down）方法和自底向上（bottom-up）方法。前者先进行人的检测，在此基础上寻找每个关节，后者反之。自顶向下的检测方法都会受到“early commitment”的影响：当人的检测失败，将无法进行下一步的检测。且检测的时间复杂度随人数的增加而增加。
  
  基于对系统可靠性及模型推广性的考虑，本文选用自底向上的方法，并借鉴了Hourglass网络设计，用先降采样，再升采样的卷积结构，辅助以嵌套的连跳结构，提取了较高层次的特征（卷积路），同时保留了原有层次的信息（跳级路），不改变数据尺寸，只改变数据深度。而且，经过初步调试，单个Hourglass网络在MPII数据集上达到了80%的精度，可以同时保证实时性和可靠性。
  
  为了使人体姿态判断的依据更加合理，我们采用3D姿态数据进行训练，以对2D图像作出3D坐标（x,y,z）预测。但是，2D检测普遍使用的热图表示方法存在以下缺点：1.“取最大值”运算是不可微的，防止了训练的端到端；2.由于深度神经网络的下采样步骤，热图的分辨率比输入图像的分辨率低，这导致不可避免的量化误差；3.使用分辨率更高的图像和热图有助于提高精度，但需要计算和存储，特别是对于三维热图。对此，我们借鉴了[5]的思想，使用如下积分取期望值的方式替代取最大值的方式：
  
  ![](https://imgchr.com/i/B3eT3T.jpg "懒得写公式了")
